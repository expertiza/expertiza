<%= error_messages_for 'questionnaire' %>

<%= form_for @questionnaire do %>
  <table>
    <tr>
      <td valign="top" class="form-inline"><label for="questionnaire_name">Name:</label>
        <%= text_field 'questionnaire', 'name', class: "form-control width-250"  %>
        <%= hidden_field 'questionnaire', 'id' %>
        <%= hidden_field 'questionnaire', 'type' %>
      </td>
    </tr>
  </table>
  <br/>
  <table>
     <tr class="form-inline">
       <td><label for="min_question_score">Min item score:</label>&nbsp;<%= text_field 'questionnaire', 'min_question_score', :size=> 1, :value=>@questionnaire.min_question_score ||= 0, :class => "form-control width-40" %>&nbsp;&nbsp;</td>
       <td><label for="max_question_score">Max item score:</label>&nbsp;<%= text_field 'questionnaire', 'max_question_score', :size=> 1, :value=>@questionnaire.max_question_score ||= 5, :class => "form-control width-40" %>&nbsp;&nbsp;</td>
       <td><label for="questionnaire_private">Is this <%= @questionnaire.display_type %> private:</label>&nbsp;<%= select(:questionnaire, :private, [ ['no', false],['yes',  true]], {}, {class: "form-control"})%>
       </td>
     </tr>
  </table>
  <% if params[:action] == 'new' %>
    <%= submit_tag 'Create', class: "btn btn-default" %>
  <% end %>
<% end %>

<!--Question part-->
<hr/>
<% if !params[:id].nil? and params[:action] == 'edit' %>
  <% if AnswerHelper.in_active_period(params[:id]) %>
    A review period is in progress. All existing reviews for the questionnaire <b>will be deleted</b> if you ADD or REMOVE a question.
  <% end %>
  <%= render :partial => 'questions' %>
  <hr/>
  <%= link_to 'Import Questionnaire', :controller=>'import_file', :action=>'start', :model => 'Question', :id=> @questionnaire.id, :expected_fields => 'txt, type ,seq,size, break_before' %>|
  <%= link_to 'Export Questionnaire', :controller=>'export_file',:action=>'start',:model=> 'Question',:id=> @questionnaire.id %>
<% end %>
<BR/>

<% if AnswerHelper.in_active_period(params[:id]) %>
    <script>
        $('a[data-method="delete"]').click(function(e) {
            return window.confirm("A review period is in progress. All existing reviews for the questionnaire would be deleted. Are you sure you want to continue?");
        });
    </script>
<% end %>
