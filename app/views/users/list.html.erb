<div ng-controller='UsersPageCtrl'> <!-- make this page available to angular controller -->
<div ng-init="init('<%= @pagediv %>')"></div>
<h1>Manage users</h1>

<br/>

<div>
<label>Search By: 
  <select ng-model="searchtype" ng-init="searchtype='any'">
    <option value="any">Any</option>
    <option value="name">Name</option>
    <option value="email">Email</option>
  </select>
</label>
<input ng-hide="searchtype != 'any'" ng-model="search.$">
<input ng-hide="searchtype != 'name'" ng-model="search.name">
<input ng-hide="searchtype != 'email'" ng-model="search.email">
<p>
</div>

<div>
<label>Paginate By: 
  <select ng-model="paginate" ng-init="paginate='0'" ng-change="pagination(paginate)">
    <option value="0">All</option>
    <option value="25">25</option>
    <option value="50">50</option>
    <option value="100">100</option>
    <option value="250">250</option>
  </select>
</label>
<p>
</div>

<button ng-disabled="currentPage == 0" ng-click="currentPage=currentPage-1">
    Previous
</button>
{{currentPage+1}}/{{div}}
<button ng-disabled="currentPage >= totalSize/pageSize - 1" ng-click="currentPage=currentPage+1">
    Next
</button>

    <table class="table table-striped table-hover table-responsive">
      <thead>
        <tr><th colspan=5></th><th colspan=4 class="head info">E-mail on ...</th></tr>
        <tr class="info">
          <th>Name</th>
          <th>Full Name</th>
          <th>Email</th>
          <th>Role</th>
          <th>Parent</th>
          <th>Review</th>
          <th>Submission</th>
          <th>Metareview</th>
          <th>Privacy</th>
        </tr>
      </thead>
      <tbody>
        <tr ng-repeat="user in users | filter:search | startFrom:currentPage*pageSize | limitTo:pageSize">
          <td>{{user.object.name}}</td>
          <td>{{user.object.fullname}}</td>
          <td>{{user.object.email}}</td>
          <td>{{user.role}}</td>
          <td>{{user.parent}}</td>
          <td>{{user.email_on_review}}</td>
          <td>{{user.email_on_submission}}</td>
          <td>{{user.email_on_review_of_review}}</td>
          <td>{{user.leaderboard_privacy}}</td>
        </tr>
      </tbody>
    </table>

<hr/>
<%= render :partial => 'shared_scripts/pages' %>

<p>
  <%
      session[:return_to] = "#{request.protocol}#{request.host_with_port}#{request.fullpath}"
    %>

  <%= link_to 'New User', :action => 'new' %> |
  <%= link_to 'Import Users', :controller=>'import_file', :action=>'start', :model => 'User', :expected_fields => 'username, full name (first[ middle] last), e-mail address, password' %>|
  <%= link_to 'Export Users', :controller=>'export_file',:action=>'start',:model=> 'User',:id=> 1 %>

</p>

</div>