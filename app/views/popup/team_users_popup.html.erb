<div>
  <h3>
    Members of #{@team.name}
  </h3>
  <table width="100%">
    <% if @team_users.empty? %>
      <tr>No team members</tr>
    <% else %>
      <% @team_users.each do |t| %>
        <tr>
          <td>
            \- #{User.find(t.user_id).fullname}
          </td>
        </tr>
      <% end %>
    <% end %>
  </table>
  <% (1..@assignment.num_review_rounds).each do |round| %>
    <% next if instance_variable_get('@response_round_' + round.to_s).nil? %>
    <% if instance_variable_get('@scores_round_' + round.to_s).nil? %>
      <tr>
        <td align="center">No review done yet.</td>
      </tr>
      <br/>
      <tr>
        <th align="left">Reviewer score</th>
      </tr>
      <tr>
        <td align="center">--</td>
      </tr>
      <br/>
    <% else %>
      <h3>
        <%= "Reviewed by #{User.find(@reviewer_id).fullname} (Round #{round})" %>
      </h3>
      <table border="1px solid #ccc" class="general">
        <tr>
          <th align="left" width="50%">Question</th>
          <th width="5%">Score</th>
          <th width="45%">Comments</th>
        </tr>
        <% instance_variable_get('@scores_round_' + round.to_s).each do |answer| %>
          <tr>
            <td align="left">
              <%= answer.question.txt %>
            </td>
            <% if answer.question.is_a?(ScoredQuestion) %>
              <td align="center">
                <%= answer.answer %>
                \/#{instance_variable_get('@max_score_round_' + round.to_s)}
              </td>
            <% elsif answer.question.is_a?(Checkbox) %>
              <td align="center">
                <%= answer.answer==0 ? image_tag("delete_icon.png"): image_tag("Check-icon.png") %>
              </td>
            <% else %>
              <td align="center">
                <%= answer.answer %>
              </td>
            <% end %>
            <td align="left">
              <%= answer.comments %>
            </td>
          </tr>
        <% end %>
        <tr>
          <th>Reviewer Score (Σ weighted score/Σ weighted available score)</th>
          <td align="center">
            <%= instance_variable_get('@sum_round_' + round.to_s) %>
            \/#{instance_variable_get('@total_possible_round_' + round.to_s)}
          </td>
          <td align="left">
            \= #{instance_variable_get('@total_percentage_round_' + round.to_s)}
          </td>
        </tr>
      </table>
      <br/>
      <table class="general" width="100%">
        <tr>
          <th>Additional Comment</th>
        </tr>
        <tr>
          <% additional_comment = Response.find(instance_variable_get('@response_id_round_' + round.to_s)).additional_comment %>
          <td>
            <%= additional_comment.nil? ? 'No Comments' : additional_comment.html_safe %>
          </td>
        </tr>
      </table>
      <hr/>
    <% end %>
  <% end %>
  <br/>
  <div class="footer">
    <%= link_to 'Back', :controller=> 'review_mapping', :action=>'response_report', :id=>params[:assignment_id] %>
  </div>
</div>
