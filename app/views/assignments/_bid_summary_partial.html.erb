<div class="bid-summary-container">
  <!-- Section title for aggregate bid data -->
  <h5>Aggregate Bid Data:</h5>
  
  <% # Check if there are any sign-up topics associated with the assignment %>
  <% if @assignment_form.assignment.sign_up_topics.any? %>
    <!-- List of topics -->
    <ul class="topic-list">
      <% # Iterate over each sign-up topic %>
      <% @assignment_form.assignment.sign_up_topics.each do |topic| %>
        <li class="topic-item">
          <!-- Display topic name -->
          <strong><%= topic.topic_name %>:</strong> 
          <!-- Display total number of bids for the topic -->
          <%= topic.bids.size %> bids - 
          <!-- Display number of bids for each priority -->
          #1 Bids: <%= topic.bids.where(priority: 1).size %>, 
          #2 Bids: <%= topic.bids.where(priority: 2).size %>,
          #3 Bids: <%= topic.bids.where(priority: 3).size %>,
          <!-- Display names of teams that bid on the topic -->
          Teams: <%= topic.bids.includes(:team).map { |bid| bid.team.name }.join(', ') %>
        </li>
        
        <% # Calculating the percentage of teams getting their first choice %>
        <% total_teams = topic.bids.size.to_f %>
        <% first_choice_bids = topic.bids.where(priority: 1).size %>
        <% if total_teams > 0 %>
          <% # Calculate percentage of teams getting their first choice -->
          <% percentage_first_choice = (first_choice_bids / total_teams * 100).round(2) %>
          <% # Color coding percentages based on value ranges -->
          <% percentage_color = if percentage_first_choice == 0
                                 "red"
                               elsif percentage_first_choice == 100
                                 "green"
                               else
                                 "orange"
                               end %>
          <!-- Display percentage of teams getting their first choice -->
          <li class="percentage-item" style="list-style-type: none;">Percentage of teams getting their first choice for <%= topic.topic_name %>: <span style="color: <%= percentage_color %>;"><%= percentage_first_choice %> %</span></li>
        <% else %>
          <!-- Display message if there are no bids for the topic -->
          <li>No bids for <%= topic.topic_name %></li>
        <% end %>
      <% end %>
    </ul>
  <% else %>
    <!-- Display message if no topics have been created for the assignment -->
    <p>No topics have been created for this assignment yet.</p>
  <% end %>
</div>
